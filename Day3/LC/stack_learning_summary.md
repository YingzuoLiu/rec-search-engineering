# 📌 Stack（栈）--- 今日学习总结

## 一、什么是栈（Stack）

**栈是一种只允许在一端操作的数据结构**，这一端叫**栈顶**。

- **后进先出（LIFO）**
- 只能：
  - 从栈顶 **push（放）**
  - 从栈顶 **pop（拿）**
  - 从栈顶 **peek / top（看）**

👉 **不能从中间或底部操作**

## 二、栈是怎么运作的（核心直觉）

可以把栈想成一摞盘子：
- 新盘子只能放在最上面
- 拿盘子也只能从最上面拿
- 最后放的，一定最先拿走

## 三、用 Python list 实现栈（最常见）

```python
stack = []
stack.append(x)  # push
stack.pop()      # pop
stack[-1]        # peek / top
```

约定：  
👉 **列表最后一个元素 = 栈顶**

## 四、peek / top vs pop 的区别（你今天搞清楚的重点）

| **操作** | **含义** | **是否改变栈** |
|----------|----------|----------------|
| pop | 拿走并删除 | ✅ 改变 |
| peek / top | 只看一眼 | ❌ 不改变 |

📌 **查询（query）要 return，修改（command）不需要 return**

## 五、为什么 Min Stack 要存两个值（关键理解）

Min Stack 的要求是：

**push / pop / top / getMin 都是 O(1)**

### 为什么不能只存一个值？

- 栈会 pop
- pop 后你会**失去历史最小值**
- getMin 就只能遍历整个栈（O(n)）

### 正确做法

**每一层存：**

```
(当前值, 当前最小值)
```

这样 pop 后：
- 自动回到上一层
- 最小值仍然是 O(1)

## 六、stack[-1][0] 和 stack[-1][1] 的真正含义

这不是 Python 规定，而是**我们自己定的结构**：

```
(value, current_min)
```

所以：
- `stack[-1][0]` → 栈顶值
- `stack[-1][1]` → 当前最小值

👉 **下标含义来自你存数据时的约定**

## 七、为什么 push 时一定要放 (val, cur_min)

因为：
- `cur_min = min(val, 上一层的最小值)`
- 这是 **push 之后** 的真实最小值
- 每一层都要"记账"，防止 pop 后信息丢失

## 八、用两个栈实现队列（Queue using Stacks）

### 设计思想

- `in_stack`：只负责入队
- `out_stack`：只负责出队 / peek

### 关键操作：倒栈

当 `out_stack` 为空时：

```python
while in_stack:
    out_stack.append(in_stack.pop())
```

👉 顺序被反转，最早入队的元素来到 `out_stack` 顶部

## 九、为什么要等 out_stack 为空才倒

- 倒栈成本是 O(n)
- 每个元素 **最多只会被倒一次**
- 整体摊销时间复杂度是 O(1)

### 用队列实现栈（LC225）——与 LC232 的对比理解 核心目标
在只允许 FIFO（队列）的前提下，实现 LIFO（栈）。

### 关键策略
把复杂度放在 `push` 阶段，通过**旋转队列**移动旧元素，让新元素始终位于队头。
```python
q.append(x)
for _ in range(len(q) - 1):
    q.append(q.pop(0))
```

### 不变量
- 队头 `q[0]` 永远是栈顶
- `top / pop` 都直接作用在队头

### 与 LC232 的对比

| 题目 | 模拟目标 | 反转发生在 | 移动对象 |
|------|----------|------------|----------|
| LC232（栈 → 队） | FIFO | 出队时 | 全部元素 |
| LC225（队 → 栈） | LIFO | 入栈时 | 旧元素 |

👉 **本质区别在于：谁对"顺序"要求更严格，就把反转放在哪个操作里。**

## 十、栈的典型使用场景
- 括号匹配 / 语法解析
- 函数调用栈 / 递归
- Undo / Redo / 回退
- DFS / 回溯
- 单调栈（最近更大 / 更小）
- 顺序反转（字符串、队列）
- Min / Max 跟踪

👉 **关键词：最近的、未完成的、需要回退的状态**
